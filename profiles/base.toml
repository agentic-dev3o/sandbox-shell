# Base sandbox profile - minimal security defaults
# Always included unless explicitly excluded

network_mode = "offline"

[filesystem]
allow_read = [
    # System paths
    "/usr",
    "/bin",
    "/sbin",
    "/opt",
    "/etc",
    "/private/etc",
    "/Library",
    "/System",
    "/private/var/db",
    "/private/var/folders",
    "/private/var/run",
    "/var/db",
    "/var/folders",
    "/var/run",
    "/tmp",
    "/dev",
    # sx config
    "~/.config/sx",
    # ~/Library - allowlist only safe subdirectories (shift-left)
    "~/Library/Caches/",
    "~/Library/Preferences/",
    "~/Library/Application Support/",
    "~/Library/Logs/",
    "~/Library/Frameworks/",
    "~/Library/Keychains/", # Encrypted, requires Security framework ACL to access secrets
    "~/Library/Developer/",
    # Shell config files (read-only)
    "~/.zshrc",
    "~/.zshenv",
    "~/.zprofile",
    "~/.bashrc",
    "~/.bash_profile",
    "~/.profile",
    "~/.inputrc",
]
# This enforce deny on critical path containing sensibles data even if user allow HOME directory in global config
deny_read = [
    "~/.ssh",
    "~/.aws",
    "~/.docker/config.json",
    "~/Documents",
    "~/Desktop",
    "~/Downloads",
]
allow_write = [
    "/tmp",
    "/private$TMPDIR", # Session-specific temp dir (canonical path)
    "$TMPDIR", # Session-specific temp dir (symlink path)
]

[shell]
pass_env = [
    "TERM",
    "COLORTERM",
    "LANG",
    "LC_ALL",
    "HOME",
    "USER",
    "SHELL",
    "PATH",
]
deny_env = [
    "AWS_*",
    "*_SECRET*",
    "*_PASSWORD*",
    "*_KEY",
]
